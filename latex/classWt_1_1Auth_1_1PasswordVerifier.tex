\hypertarget{classWt_1_1Auth_1_1PasswordVerifier}{}\doxysection{Wt\+::Auth\+::Password\+Verifier Class Reference}
\label{classWt_1_1Auth_1_1PasswordVerifier}\index{Wt::Auth::PasswordVerifier@{Wt::Auth::PasswordVerifier}}


Password hash computation and verification class.  




{\ttfamily \#include $<$Wt/\+Auth/\+Password\+Verifier.\+h$>$}



Inheritance diagram for Wt\+::Auth\+::Password\+Verifier\+:
% FIG 0


Collaboration diagram for Wt\+::Auth\+::Password\+Verifier\+:
% FIG 1
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classWt_1_1Auth_1_1PasswordVerifier_a3aa61534cbd936e01599d55dfe001d23}\label{classWt_1_1Auth_1_1PasswordVerifier_a3aa61534cbd936e01599d55dfe001d23}} 
\mbox{\hyperlink{classWt_1_1Auth_1_1PasswordVerifier_a3aa61534cbd936e01599d55dfe001d23}{Password\+Verifier}} ()
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classWt_1_1Auth_1_1PasswordVerifier_a6ea7992a4790419043c37baf48271e0a}\label{classWt_1_1Auth_1_1PasswordVerifier_a6ea7992a4790419043c37baf48271e0a}} 
{\bfseries Password\+Verifier} (const \mbox{\hyperlink{classWt_1_1Auth_1_1PasswordVerifier}{Password\+Verifier}} \&)=delete
\item 
\mbox{\Hypertarget{classWt_1_1Auth_1_1PasswordVerifier_a5e491c0a7ff9e0bdc67ceb762e932206}\label{classWt_1_1Auth_1_1PasswordVerifier_a5e491c0a7ff9e0bdc67ceb762e932206}} 
\mbox{\hyperlink{classWt_1_1Auth_1_1PasswordVerifier}{Password\+Verifier}} \& {\bfseries operator=} (const \mbox{\hyperlink{classWt_1_1Auth_1_1PasswordVerifier}{Password\+Verifier}} \&)=delete
\item 
\mbox{\Hypertarget{classWt_1_1Auth_1_1PasswordVerifier_a2dad75b97560325d3d242dd074f0af11}\label{classWt_1_1Auth_1_1PasswordVerifier_a2dad75b97560325d3d242dd074f0af11}} 
virtual \mbox{\hyperlink{classWt_1_1Auth_1_1PasswordVerifier_a2dad75b97560325d3d242dd074f0af11}{$\sim$\+Password\+Verifier}} ()
\begin{DoxyCompactList}\small\item\em Destructor. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classWt_1_1Auth_1_1PasswordVerifier_a8fdc288c1d54b7e0dedbab982ad4bf26}{set\+Salt\+Length}} (int words)
\begin{DoxyCompactList}\small\item\em Sets the salt length. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classWt_1_1Auth_1_1PasswordVerifier_a54f3ebd1c38048059d8e197bc385cf0b}\label{classWt_1_1Auth_1_1PasswordVerifier_a54f3ebd1c38048059d8e197bc385cf0b}} 
int \mbox{\hyperlink{classWt_1_1Auth_1_1PasswordVerifier_a54f3ebd1c38048059d8e197bc385cf0b}{salt\+Length}} () const
\begin{DoxyCompactList}\small\item\em Returns the salt length. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classWt_1_1Auth_1_1PasswordVerifier_af925131513a9f2e6fe2e28c6807c8aa3}{add\+Hash\+Function}} (std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classWt_1_1Auth_1_1HashFunction}{Hash\+Function}} $>$ function)
\begin{DoxyCompactList}\small\item\em Adds a hash function. \end{DoxyCompactList}\item 
const std\+::vector$<$ \mbox{\hyperlink{classWt_1_1Auth_1_1HashFunction}{Hash\+Function}} $\ast$ $>$ \mbox{\hyperlink{classWt_1_1Auth_1_1PasswordVerifier_a815bdcc006284eaec520d39502e387ef}{hash\+Functions}} () const
\begin{DoxyCompactList}\small\item\em Returns the list of hash functions. \end{DoxyCompactList}\item 
virtual bool \mbox{\hyperlink{classWt_1_1Auth_1_1PasswordVerifier_a4c80abe9a4144fc49417d19ab7eaf4a0}{needs\+Update}} (const \mbox{\hyperlink{classWt_1_1Auth_1_1PasswordHash}{Password\+Hash}} \&hash) const override
\begin{DoxyCompactList}\small\item\em Returns whether a password hash needs to be updated (recomputed). \end{DoxyCompactList}\item 
virtual \mbox{\hyperlink{classWt_1_1Auth_1_1PasswordHash}{Password\+Hash}} \mbox{\hyperlink{classWt_1_1Auth_1_1PasswordVerifier_ae5e9987d711a06ca1564982c32594d89}{hash\+Password}} (const \mbox{\hyperlink{classWt_1_1WString}{W\+String}} \&password) const override
\begin{DoxyCompactList}\small\item\em Computes the password hash for a clear text password. \end{DoxyCompactList}\item 
virtual bool \mbox{\hyperlink{classWt_1_1Auth_1_1PasswordVerifier_a105428de559553a2df55b72a4d3779fa}{verify}} (const \mbox{\hyperlink{classWt_1_1WString}{W\+String}} \&password, const \mbox{\hyperlink{classWt_1_1Auth_1_1PasswordHash}{Password\+Hash}} \&hash) const override
\begin{DoxyCompactList}\small\item\em Verifies a password against a hash. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classWt_1_1Auth_1_1PasswordVerifier_a7ceabac0afe2aab8af3a23872b4dea6c}\label{classWt_1_1Auth_1_1PasswordVerifier_a7ceabac0afe2aab8af3a23872b4dea6c}} 
std\+::vector$<$ std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classWt_1_1Auth_1_1HashFunction}{Hash\+Function}} $>$ $>$ {\bfseries hash\+Functions\+\_\+}
\item 
\mbox{\Hypertarget{classWt_1_1Auth_1_1PasswordVerifier_af3aa1cb6b5ebcc83dc0f8aa3c94ddfef}\label{classWt_1_1Auth_1_1PasswordVerifier_af3aa1cb6b5ebcc83dc0f8aa3c94ddfef}} 
int {\bfseries salt\+Length\+\_\+}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Password hash computation and verification class. 

This class implements the logic for comparing passwords against password hashes, or computing a new password hash for a password.

One or more hash functions can be added, which allow you to introduce a new \char`\"{}preferred\char`\"{} hash function while maintaining support for verifying existing passwords hashes. 

\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classWt_1_1Auth_1_1PasswordVerifier_af925131513a9f2e6fe2e28c6807c8aa3}\label{classWt_1_1Auth_1_1PasswordVerifier_af925131513a9f2e6fe2e28c6807c8aa3}} 
\index{Wt::Auth::PasswordVerifier@{Wt::Auth::PasswordVerifier}!addHashFunction@{addHashFunction}}
\index{addHashFunction@{addHashFunction}!Wt::Auth::PasswordVerifier@{Wt::Auth::PasswordVerifier}}
\doxysubsubsection{\texorpdfstring{addHashFunction()}{addHashFunction()}}
{\footnotesize\ttfamily void Wt\+::\+Auth\+::\+Password\+Verifier\+::add\+Hash\+Function (\begin{DoxyParamCaption}\item[{std\+::unique\+\_\+ptr$<$ \mbox{\hyperlink{classWt_1_1Auth_1_1HashFunction}{Hash\+Function}} $>$}]{function }\end{DoxyParamCaption})}



Adds a hash function. 

The first hash function added is the one that will be used for creating new password hashes, i.\+e. the \char`\"{}preferred\char`\"{} hash function. The other hash functions are used only for verifying existing hash passwords. This allows you to move to new hash functions as other ones are no longer deemed secure.

Each hash function has a unique name, which is annotated in the generated hash to identify the appropriate hash funtion to evaluate it.

Ownership of the hash functions is transferred.

\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{classWt_1_1Auth_1_1PasswordVerifier_a815bdcc006284eaec520d39502e387ef}{hash\+Functions()}} 
\end{DoxySeeAlso}
\mbox{\Hypertarget{classWt_1_1Auth_1_1PasswordVerifier_a815bdcc006284eaec520d39502e387ef}\label{classWt_1_1Auth_1_1PasswordVerifier_a815bdcc006284eaec520d39502e387ef}} 
\index{Wt::Auth::PasswordVerifier@{Wt::Auth::PasswordVerifier}!hashFunctions@{hashFunctions}}
\index{hashFunctions@{hashFunctions}!Wt::Auth::PasswordVerifier@{Wt::Auth::PasswordVerifier}}
\doxysubsubsection{\texorpdfstring{hashFunctions()}{hashFunctions()}}
{\footnotesize\ttfamily const std\+::vector$<$\mbox{\hyperlink{classWt_1_1Auth_1_1HashFunction}{Hash\+Function}} $\ast$$>$ Wt\+::\+Auth\+::\+Password\+Verifier\+::hash\+Functions (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}



Returns the list of hash functions. 

This returns a list with references to hashfunctions that have been added with \mbox{\hyperlink{classWt_1_1Auth_1_1PasswordVerifier_af925131513a9f2e6fe2e28c6807c8aa3}{add\+Hash\+Function()}}. \mbox{\Hypertarget{classWt_1_1Auth_1_1PasswordVerifier_ae5e9987d711a06ca1564982c32594d89}\label{classWt_1_1Auth_1_1PasswordVerifier_ae5e9987d711a06ca1564982c32594d89}} 
\index{Wt::Auth::PasswordVerifier@{Wt::Auth::PasswordVerifier}!hashPassword@{hashPassword}}
\index{hashPassword@{hashPassword}!Wt::Auth::PasswordVerifier@{Wt::Auth::PasswordVerifier}}
\doxysubsubsection{\texorpdfstring{hashPassword()}{hashPassword()}}
{\footnotesize\ttfamily virtual \mbox{\hyperlink{classWt_1_1Auth_1_1PasswordHash}{Password\+Hash}} Wt\+::\+Auth\+::\+Password\+Verifier\+::hash\+Password (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classWt_1_1WString}{W\+String}} \&}]{password }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Computes the password hash for a clear text password. 

This creates new salt and applies the \char`\"{}preferred\char`\"{} hash function to the salt and clear text password to compute the hash.

\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{classWt_1_1Auth_1_1PasswordVerifier_a105428de559553a2df55b72a4d3779fa}{verify()}} 
\end{DoxySeeAlso}


Implements \mbox{\hyperlink{classWt_1_1Auth_1_1PasswordService_1_1AbstractVerifier_a6c0edcfd38d6c4a656ffded44b007023}{Wt\+::\+Auth\+::\+Password\+Service\+::\+Abstract\+Verifier}}.

\mbox{\Hypertarget{classWt_1_1Auth_1_1PasswordVerifier_a4c80abe9a4144fc49417d19ab7eaf4a0}\label{classWt_1_1Auth_1_1PasswordVerifier_a4c80abe9a4144fc49417d19ab7eaf4a0}} 
\index{Wt::Auth::PasswordVerifier@{Wt::Auth::PasswordVerifier}!needsUpdate@{needsUpdate}}
\index{needsUpdate@{needsUpdate}!Wt::Auth::PasswordVerifier@{Wt::Auth::PasswordVerifier}}
\doxysubsubsection{\texorpdfstring{needsUpdate()}{needsUpdate()}}
{\footnotesize\ttfamily virtual bool Wt\+::\+Auth\+::\+Password\+Verifier\+::needs\+Update (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classWt_1_1Auth_1_1PasswordHash}{Password\+Hash}} \&}]{hash }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Returns whether a password hash needs to be updated (recomputed). 

A {\ttfamily hash} may need to be updated if it has been computed with a cryptographic method that is being disfavoured. 

Implements \mbox{\hyperlink{classWt_1_1Auth_1_1PasswordService_1_1AbstractVerifier_a9991518e71092b356ae4e66fede088c3}{Wt\+::\+Auth\+::\+Password\+Service\+::\+Abstract\+Verifier}}.

\mbox{\Hypertarget{classWt_1_1Auth_1_1PasswordVerifier_a8fdc288c1d54b7e0dedbab982ad4bf26}\label{classWt_1_1Auth_1_1PasswordVerifier_a8fdc288c1d54b7e0dedbab982ad4bf26}} 
\index{Wt::Auth::PasswordVerifier@{Wt::Auth::PasswordVerifier}!setSaltLength@{setSaltLength}}
\index{setSaltLength@{setSaltLength}!Wt::Auth::PasswordVerifier@{Wt::Auth::PasswordVerifier}}
\doxysubsubsection{\texorpdfstring{setSaltLength()}{setSaltLength()}}
{\footnotesize\ttfamily void Wt\+::\+Auth\+::\+Password\+Verifier\+::set\+Salt\+Length (\begin{DoxyParamCaption}\item[{int}]{words }\end{DoxyParamCaption})}



Sets the salt length. 

The salt length is used to create new salt when a new password is being hashed.

The salt length is specified in bytes, but should be a multiple of 3 (so that Base64 encoding yields an integral number of bytes).

The default length is 12.

\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{classWt_1_1Auth_1_1PasswordVerifier_ae5e9987d711a06ca1564982c32594d89}{hash\+Password()}} 
\end{DoxySeeAlso}
\mbox{\Hypertarget{classWt_1_1Auth_1_1PasswordVerifier_a105428de559553a2df55b72a4d3779fa}\label{classWt_1_1Auth_1_1PasswordVerifier_a105428de559553a2df55b72a4d3779fa}} 
\index{Wt::Auth::PasswordVerifier@{Wt::Auth::PasswordVerifier}!verify@{verify}}
\index{verify@{verify}!Wt::Auth::PasswordVerifier@{Wt::Auth::PasswordVerifier}}
\doxysubsubsection{\texorpdfstring{verify()}{verify()}}
{\footnotesize\ttfamily virtual bool Wt\+::\+Auth\+::\+Password\+Verifier\+::verify (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classWt_1_1WString}{W\+String}} \&}]{password,  }\item[{const \mbox{\hyperlink{classWt_1_1Auth_1_1PasswordHash}{Password\+Hash}} \&}]{hash }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Verifies a password against a hash. 

This verifies whether the password matches the hash.

\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{classWt_1_1Auth_1_1PasswordVerifier_ae5e9987d711a06ca1564982c32594d89}{hash\+Password()}} 
\end{DoxySeeAlso}


Implements \mbox{\hyperlink{classWt_1_1Auth_1_1PasswordService_1_1AbstractVerifier_a90b8136ba2c6f77fe420445653f56a6a}{Wt\+::\+Auth\+::\+Password\+Service\+::\+Abstract\+Verifier}}.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
wt-\/4.\+8.\+2/src/\+Wt/\+Auth/Password\+Verifier.\+h\end{DoxyCompactItemize}
